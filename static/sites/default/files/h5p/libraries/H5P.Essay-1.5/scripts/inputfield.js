var H5P=H5P||{};(function(Essay){'use strict';var MAIN_CONTAINER='h5p-essay-input-field';var INPUT_LABEL='h5p-essay-input-field-label';var INPUT_FIELD='h5p-essay-input-field-textfield';var WRAPPER_MESSAGE='h5p-essay-input-field-message-wrapper';var CHAR_MESSAGE='h5p-essay-input-field-message-char';var CHAR_MESSAGE_IMPORTANT='h5p-essay-input-field-message-char-important';var SAVE_MESSAGE='h5p-essay-input-field-message-save';var ANIMATION_MESSAGE='h5p-essay-input-field-message-save-animation';var EMPTY_MESSAGE='&nbsp;';Essay.InputField=function(params,callbacks){var that=this;this.params=params;this.previousState=params.previousState||'';this.callbacks=callbacks||{};this.callbacks.onInteracted=this.callbacks.onInteracted||(function(){});this.params.taskDescription=this.params.taskDescription||'';this.params.placeholderText=this.params.placeholderText||'';this.taskDescription=document.createElement('div');this.taskDescription.classList.add(INPUT_LABEL);this.taskDescription.innerHTML=this.params.taskDescription;this.inputField=document.createElement('textarea');this.inputField.classList.add(INPUT_FIELD);this.inputField.setAttribute('rows',this.params.inputFieldSize);this.inputField.setAttribute('maxlength',this.params.maximumLength);this.inputField.setAttribute('placeholder',this.params.placeholderText);this.setText(this.previousState);this.oldValue=this.previousState;this.containsText=this.oldValue.length>0;this.inputField.addEventListener('blur',function(){if(that.oldValue!==that.getText()){that.callbacks.onInteracted({updateScore:true});}
that.oldValue=that.getText();});this.inputField.addEventListener('input',function(){if(that.containsText&&that.getText().length===0||!that.containsText&&that.getText().length>0){that.callbacks.onInteracted();}
that.containsText=that.getText().length>0;});this.content=document.createElement('div');this.content.appendChild(this.inputField);this.container=document.createElement('div');this.container.classList.add(MAIN_CONTAINER);this.container.appendChild(this.taskDescription);this.container.appendChild(this.content);if(params.statusBar){var statusWrapper=document.createElement('div');statusWrapper.classList.add(WRAPPER_MESSAGE);this.statusChars=document.createElement('div');this.statusChars.classList.add(CHAR_MESSAGE);statusWrapper.appendChild(this.statusChars);['change','keyup','paste'].forEach(function(event){that.inputField.addEventListener(event,function(){that.updateMessageSaved('');that.updateMessageChars();});});this.statusSaved=document.createElement('div');this.statusSaved.classList.add(SAVE_MESSAGE);statusWrapper.appendChild(this.statusSaved);this.content.appendChild(statusWrapper);this.updateMessageChars();}};Essay.InputField.prototype.getIntroduction=function(){return this.taskDescription;};Essay.InputField.prototype.getContent=function(){return this.content;};Essay.InputField.prototype.getText=function(){return this.inputField.value;};Essay.InputField.prototype.disable=function(){this.inputField.disabled=true;};Essay.InputField.prototype.enable=function(){this.inputField.disabled=false;};Essay.InputField.prototype.focus=function(){this.inputField.focus();};Essay.InputField.prototype.setText=function(value){const type=(typeof value);if(type==='undefined'){return;}
if(type==='string'){this.inputField.value=value;}
else if(type==='object'&&!Array.isArray(value)){this.inputField.value=value.inputField||'';}};Essay.InputField.prototype.computeRemainingChars=function(){return this.params.maximumLength-this.inputField.value.length;};Essay.InputField.prototype.updateMessageChars=function(){if(!this.params.statusBar){return;}
if(typeof this.params.maximumLength!=='undefined'){this.setMessageChars(this.params.remainingChars.replace(/@chars/g,this.computeRemainingChars()),false);}
else{this.setMessageChars(EMPTY_MESSAGE,false);}};Essay.InputField.prototype.updateMessageSaved=function(saved){if(!this.params.statusBar){return;}
if(typeof saved==='undefined'||saved===''){this.statusSaved.classList.remove(ANIMATION_MESSAGE);}
else{this.statusSaved.classList.add(ANIMATION_MESSAGE);}
this.statusSaved.innerHTML=saved;};Essay.InputField.prototype.setMessageChars=function(message,important){if(!this.params.statusBar){return;}
if(typeof message!=='string'){return;}
if(message===EMPTY_MESSAGE||important){this.statusChars.removeAttribute('tabindex');}
else{this.statusChars.setAttribute('tabindex',0);}
this.statusChars.innerHTML=message;if(important){this.statusChars.classList.add(CHAR_MESSAGE_IMPORTANT);}
else{this.statusChars.classList.remove(CHAR_MESSAGE_IMPORTANT);}};})(H5P.Essay);